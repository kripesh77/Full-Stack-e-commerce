<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="/favicon.jpg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AliSasto</title>

    <!-- Preload critical fonts -->
    <link
      rel="preload"
      href="/src/assets/font/geograph-bold.woff2"
      as="font"
      type="font/woff2"
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      href="/src/assets/font/geograph-regular.woff2"
      as="font"
      type="font/woff2"
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      href="/src/assets/font/geograph-medium.woff2"
      as="font"
      type="font/woff2"
      crossorigin="anonymous"
    />
    <link
      rel="preload"
      href="/src/assets/font/Asimovian-Regular.ttf"
      as="font"
      type="font/ttf"
      crossorigin="anonymous"
    />

    <!-- Preload critical landing page background images -->
    <link
      rel="preload"
      href="https://images.unsplash.com/photo-1611004061262-3a925aa7fc31?q=80&w=1932&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
      as="image"
    />
    <link
      rel="preload"
      href="https://plus.unsplash.com/premium_photo-1744395627552-1349f5d80199?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1yZWxhdGVkfDR8fHxlbnwwfHx8fHw%3D"
      as="image"
    />
    <link
      rel="preload"
      href="https://images.unsplash.com/photo-1630547752213-af38cfb722bd?q=80&w=435&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
      as="image"
    />

    <!-- Preload carousel/swiper images -->
    <link rel="preload" href="/landing-page-helmet.jpg" as="image" type="image/jpg" />
    <link rel="preload" href="/1d.png" as="image" type="image/png" />
    <link rel="preload" href="/2b.png" as="image" type="image/png" />
    <link rel="preload" href="/3.jpg" as="image" type="image/jpg" />
    <link rel="preload" href="/3a.jpg" as="image" type="image/jpg" />
  </head>

  <body>
    <div id="preloader"></div>
    
    <!-- Spinner for page transitions - outside preloader so it's always accessible -->
    <div class="c-loader_spinner">
      <div></div>
      <div></div>
      <div></div>
      <div></div>
    </div>

    <div id="root"></div>

    <style>
      html {
        background-color: #0f0f0f;
      }

      #preloader {
        position: fixed;
        inset: 0;
        display: flex;
        justify-content: flex-end;
        align-items: flex-end;
        background: #0a0a0a;
        z-index: 9999;
        overflow: hidden;
        transition: background 0.3s ease;
        padding: 2rem;
      }

      .c-loader_spinner {
        position: fixed; /* Changed to fixed so it's always visible during transitions */
        bottom: 0.625rem;
        right: 0.625rem;
        width: 3.125rem;
        height: 1.7578125rem;
        display: flex;
        transform: scaleY(var(--sy, 0));
        transform-origin: center bottom;
        transition: transform 0.3s 0.3s cubic-bezier(0.215, 0.61, 0.355, 1);
        z-index: 10000;
        pointer-events: none;
      }

      html:not(.is-loaded) .c-loader_spinner {
        transform: scaleY(var(--sy, 1));
        transition: all .3s .2s cubic-bezier(0.215, 0.61, 0.355, 1);
      }

      .c-loader_spinner div {
        flex-grow: 1;
        background-color: #ffffff;
        animation: loaderSpinnerCol 1s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
        margin-left: -1px;
      }

      .c-loader_spinner div:nth-child(1) {
        animation-delay: -0.1s;
      }

      .c-loader_spinner div:nth-child(2) {
        animation-delay: -0.2s;
      }

      .c-loader_spinner div:nth-child(3) {
        animation-delay: -0.3s;
      }

      .c-loader_spinner div:nth-child(4) {
        animation-delay: -0.4s;
      }

      @keyframes loaderSpinnerCol {
        0% {
          transform: scale3d(1, 0.25, 1);
          transform-origin: bottom center;
        }
        50% {
          transform: scale3d(1, 1, 1);
          transform-origin: bottom center;
        }
        100% {
          transform: scale3d(1, 0.25, 1);
          transform-origin: bottom center;
        }
      }
    </style>

    <script>
      // Wait for critical resources before loading React
      (function () {
        let resourcesLoaded = false;

        function checkResourcesLoaded() {
          const fontsReady =
            document.fonts.check("16px geograph-regular") &&
            document.fonts.check("16px geograph-bold") &&
            document.fonts.check("16px geograph-medium");

          const images = document.querySelectorAll('link[rel="preload"][as="image"]');
          let imagesLoaded = true;

          if (images.length > 0) {
            images.forEach((link) => {
              const img = new Image();
              img.src = link.href;
              if (!img.complete) {
                imagesLoaded = false;
              }
            });
          }

          return fontsReady && imagesLoaded;
        }

        const maxWait = 4000;
        const startTime = Date.now();

        function waitForResources() {
          if (checkResourcesLoaded() || Date.now() - startTime > maxWait) {
            resourcesLoaded = true;
          } else {
            requestAnimationFrame(waitForResources);
          }
        }

        document.fonts.ready
          .then(() => {
            waitForResources();
          })
          .catch(() => {
            setTimeout(() => {
              resourcesLoaded = true;
            }, maxWait);
          });
      })();
    </script>

    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
